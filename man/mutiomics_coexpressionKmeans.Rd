% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mutiomics_coexpressionKmeans.R
\name{mutiomics_coexpressionKmeans}
\alias{mutiomics_coexpressionKmeans}
\title{Multi-Omics Coexpression Clustering and Visualization with KMeans}
\usage{
mutiomics_coexpressionKmeans(
  omics1_exp,
  omics2_exp,
  omics1_type = "Metabolome",
  omics2_type = "Proteome",
  groupInfo,
  psych.corr.test.method = "pearson",
  pvaluecutoff = 0.01,
  coefficientcutoff = 0.8,
  clustercounts = NULL,
  positive_only = TRUE,
  omics1.linecolor = "#ffb6ce",
  omics1.meancolor = "#E1151D",
  omics2.linecolor = "#7895c3",
  omics2.meancolor = "#103883"
)
}
\arguments{
\item{omics1_exp}{A data frame of the upstream omics expression matrix (e.g., metabolomics). Rows are features (e.g., metabolites), columns are samples.}

\item{omics2_exp}{A data frame of the downstream omics expression matrix (e.g., proteomics). Rows are features (e.g., proteins), columns are samples.}

\item{omics1_type}{A character string representing the name of the upstream omics type. Default is \code{"Metabolome"}.}

\item{omics2_type}{A character string representing the name of the downstream omics type. Default is \code{"Proteome"}.}

\item{groupInfo}{A data frame with exactly \strong{two columns}: \code{Condition} and \code{sample}. \code{Condition} is the group/condition name; \code{sample} corresponds to column names of \code{omics1_exp} and \code{omics2_exp}.}

\item{psych.corr.test.method}{Correlation method to use (\code{"pearson"} or \code{"spearman"}). Default is \code{"pearson"}.}

\item{pvaluecutoff}{Significance cutoff for correlation p-value. Default is \code{0.01}.}

\item{coefficientcutoff}{Absolute correlation coefficient cutoff. Default is \code{0.8}.}

\item{clustercounts}{Number of clusters to use in KMeans. If \code{NULL}, the optimal number will be estimated automatically via \code{cascadeKM}. Default is \code{NULL}.}

\item{positive_only}{Logical. If \code{TRUE}, only proteins positively correlated with metabolites are retained. Default is \code{TRUE}.}

\item{omics1.linecolor}{Color for individual lines in upstream omics plots. Default is \code{"#ffb6ce"}.}

\item{omics1.meancolor}{Color for mean line in upstream omics plots. Default is \code{"#E1151D"}.}

\item{omics2.linecolor}{Color for individual lines in downstream omics plots. Default is \code{"#7895c3"}.}

\item{omics2.meancolor}{Color for mean line in downstream omics plots. Default is \code{"#103883"}.}
}
\value{
A list containing:
\item{plot}{A patchwork plot object visualizing aligned clusters of omics1 and omics2.}
\item{omics1cluster}{Clustered upstream omics (omics1) data with z-score normalization.}
\item{omics2_coexpression_cluster}{Filtered and aligned downstream omics (omics2) data based on coexpression.}
\item{mutiomics_coexpression}{A data frame of significant coexpression pairs and their correlation statistics.}
}
\description{
This function performs multi-omics coexpression analysis between two omics datasets
(e.g., metabolome and proteome), including group-wise mean calculation, KMeans clustering,
pairwise correlation, and aligned cluster visualization.
}
\examples{
\dontrun{
data("metaRawdata")
data("proteinRawdata")
data("sampleInfo")

meta_expr <- metaRawdata_pos |> column_to_rownames("ID")
protein_expr <- proteinRawdata |> column_to_rownames("ID")

result <- mutiomics_coexpressionKmeans(
  omics1_exp = meta_expr,
  omics2_exp = protein_expr,
  groupInfo = sampleInfo,
  coefficientcutoff = 0.9,
  clustercounts = NULL,
  positive_only = TRUE
)

# View plot
result$plot
# Save result
saveRDS(result, file = "coexpression_result.rds")
}

}
